<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.256">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Integration III</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="week13_files/libs/clipboard/clipboard.min.js"></script>
<script src="week13_files/libs/quarto-html/quarto.js"></script>
<script src="week13_files/libs/quarto-html/popper.min.js"></script>
<script src="week13_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="week13_files/libs/quarto-html/anchor.min.js"></script>
<link href="week13_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week13_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="week13_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="week13_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="week13_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#monte-carlo-techniques" id="toc-monte-carlo-techniques" class="nav-link active" data-scroll-target="#monte-carlo-techniques"><span class="toc-section-number">1</span>  Monte Carlo techniques</a>
  <ul class="collapse">
  <li><a href="#random-numbers" id="toc-random-numbers" class="nav-link" data-scroll-target="#random-numbers"><span class="toc-section-number">1.1</span>  Random Numbers</a></li>
  <li><a href="#random-numbers-in-python" id="toc-random-numbers-in-python" class="nav-link" data-scroll-target="#random-numbers-in-python"><span class="toc-section-number">1.2</span>  Random Numbers in Python</a></li>
  <li><a href="#monte-carlo-quadrature" id="toc-monte-carlo-quadrature" class="nav-link" data-scroll-target="#monte-carlo-quadrature"><span class="toc-section-number">1.3</span>  Monte Carlo Quadrature</a>
  <ul class="collapse">
  <li><a href="#probability-summary" id="toc-probability-summary" class="nav-link" data-scroll-target="#probability-summary">Probability Summary</a></li>
  <li><a href="#population-mean-and-population-variance" id="toc-population-mean-and-population-variance" class="nav-link" data-scroll-target="#population-mean-and-population-variance">Population Mean and Population Variance</a></li>
  <li><a href="#sample-mean-and-its-variance" id="toc-sample-mean-and-its-variance" class="nav-link" data-scroll-target="#sample-mean-and-its-variance">Sample Mean and Its Variance</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Numerical Integration III</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="monte-carlo-techniques" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Monte Carlo techniques</h1>
<p><em>Monte Carlo techniques</em> employ random numbers to tackle either naturally stochastic processes or nonprobabilistic problems.In keeping with the theme of the present chapter, we will focus on the latter, namely numerical integration. We start by discussing what “random” numbers are; we then turn to a detailed discussion of one-dimensional Monte Carlo quadrature, before addressing the real-world problem of multidimensional integration.</p>
<section id="random-numbers" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="random-numbers"><span class="header-section-number">1.1</span> Random Numbers</h2>
<p>Let us consider a nice example of patterns is the decimal digits of the number <span class="math inline">\pi</span>: <span class="math display">
\pi = 3.14159265358979323846264338327950\dots
</span> Random simply means that you can not predict the following digit based on the previous digits. In other words, probabbilities for the appearance of any number (<span class="math inline">0-9</span>) in the following digit are equally likely.</p>
<p>On the other hand, computers produce what are known as <em>pseudorandom numbers</em>: the use of the modifier “pseudo” is due to the fact that computers are (supposed to be) deterministic systems. Thus, they produce sequences where each number is completely determined by its predecessor(s). However, if someone who does not have access to the random-number generation algorithm is led to believe that the sequence is truly random, then we have a “good” random-number generator. Thus, when dealing with good pseudorandom number sequences we tend to simply drop the “pseudo” and speak simply of random-number sequences.</p>
</section>
<section id="random-numbers-in-python" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="random-numbers-in-python"><span class="header-section-number">1.2</span> Random Numbers in Python</h2>
<p>Python itself includes a high-quality generator in the random module.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">314159</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(random.random())</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(random.random())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.19236379321481523
0.2868424512347926</code></pre>
</div>
</div>
<p>We first call the <code>random.seed()</code> function to provide the seed (which can be thought as the starting point for a (pseudo-) random number generator). We then see that repeated invocations to the <code>random.random()</code> function lead to new random numbers, uniformly distributed in <span class="math inline">[0, 1)</span> (meaning any numbers in between is equally likely to appear).</p>
<p>If you need several random numbers stored in an array, you could hand-roll a solution using <code>random.random()</code>. However, it’s probably best to directly employ the functionality contained in <code>numpy.random.uniform()</code>: this function takes in three parameters: the first two determine the interval <span class="math inline">[a,b)</span> while the third one contains the shape of the output array:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">313159</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,(<span class="dv">2</span>,<span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 0.5792603  -0.68717081  0.3347907  -0.88203901]
[[-0.60110989  0.48781171  0.91841034]
 [-0.85697526  0.65842403  0.7414521 ]]</code></pre>
</div>
</div>
</section>
<section id="monte-carlo-quadrature" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="monte-carlo-quadrature"><span class="header-section-number">1.3</span> Monte Carlo Quadrature</h2>
<p>We now turn to the question of how random numbers can be used to compute integrals, starting from the one-dimensional case for simplicity.</p>
<section id="probability-summary" class="level3">
<h3 class="anchored" data-anchor-id="probability-summary">Probability Summary</h3>
<section id="discrete-random-variables" class="level4">
<h4 class="anchored" data-anchor-id="discrete-random-variables">Discrete Random Variables</h4>
<p>Consider a discrete random variable <span class="math inline">X</span>: its possible values are xi, each one appearing with the corresponding probability <span class="math inline">p_i^X</span> i . Observe that we are using an upper-case symbol for the random variable and a lower-case symbol for its possible values.</p>
<p><strong>Mean and variance</strong> The <em>expectation</em> of this random variable (also known as the mean value or expected value) is simply: <span class="math display">
\braket{X} = \sum_{i}p_i^X x_i.
</span> One can take the expected value of other quantities, for example the random variable <span class="math inline">X^2</span>. This is called the second moment of <span class="math inline">X</span> and is simply: <span class="math display">
\braket{X^2} = \sum_i p_i^X x_i^2.
</span> This helps us calculate another useful quantity, known as the <em>variance</em>, <span class="math inline">\mathrm{var}(X)</span>. The variance is the expectation of the random variable <span class="math inline">(X -\braket{X})^2</span>: <span class="math display">
\mathrm{var}(X) = \braket{[ X - \braket{X}]^2}.
</span></p>
<p>A simple calculation leads to an alternative expression for the variance: <span class="math display">
\begin{align*}
\mathrm{var}(X) &amp;= \braket{X^2 + \braket{X}^2 - 2X\braket{X}} = \braket{X^2} + \braket{\braket{X}^2} - \braket{2X\braket{X}} \\
&amp; = \braket{X^2} + \braket{X}^2 - 2\braket{X}^2 =\braket{X^2} - \braket{X}^2.
\end{align*}
</span> where we have used the property that <span class="math display">
\braket{aX + b X^2} = a\braket{X} + b \braket{X^2},
</span> namely the <span class="math inline">\braket{\cdot}</span> operation is linear.</p>
<p>Another concept that is often used is that of the <em>standard deviation</em>; this is simply the square root of the variance, <span class="math inline">\mathrm{var}(X)</span>.</p>
<p>If <span class="math inline">X</span> is a random variable, then <span class="math inline">f(X)</span> will also be a random variable: taking possible values <span class="math inline">f(x_i)</span> with probability <span class="math inline">p_i^X</span>. Thus, it has expectation <span class="math display">
\braket{f(X)} = \sum_{i}p_i^X f(x_i)
</span> and, similarly, its variance is: <span class="math display">
\begin{align*}
\mathrm{var}[f(X)] &amp;= \braket{[f(X) - \braket{f(X)}]^2} = \braket{f^2(X)} - \braket{f(X)}^2
\end{align*}
</span></p>
</section>
<section id="continuous-random-variables" class="level4">
<h4 class="anchored" data-anchor-id="continuous-random-variables">Continuous Random Variables</h4>
<p>For the case of a continuous random variable <span class="math inline">X</span> we are faced with a <em>probability density function</em>, <span class="math inline">p(x)</span>, which plays the role <span class="math inline">p_i^X</span> played in the discrete case. We typically assume that the probability density function is normalized, i.e.: <span class="math display">
\int_{-\infty}^{\infty} p(x)dx = 1
</span> holds. The definition of the expectation is: <span class="math display">
\braket{X} = \int_{-\infty}^{\infty}x p(x) dx.
</span></p>
<p>Similarly, we have for the <em>variance</em>: <span class="math display">
\begin{align*}
\mathrm{var}(X) &amp;= \braket{[X - \braket{X}]^2} = \int_{-\infty}^{\infty} (x - \braket{X})^2 p(x) dx \\
&amp; = \braket{X^2} - \braket{X}^2
\end{align*}
</span></p>
<p>Similar to the case for discrete random variable, if <span class="math inline">X</span> is a continuous variable, the <span class="math inline">f(X)</span> is also a continuous variable.</p>
</section>
</section>
<section id="population-mean-and-population-variance" class="level3">
<h3 class="anchored" data-anchor-id="population-mean-and-population-variance">Population Mean and Population Variance</h3>
<p>From probability theory, we know that the expectation of a function f of a continuous random variable <span class="math inline">X</span> is <span class="math display">
f(X) = \int_{-\infty}^{\infty}p(x) f(x)dx.
</span></p>
<p>For now, we take <span class="math inline">p(x)</span>, the probability density function, to be uniform from <span class="math inline">a</span> to <span class="math inline">b</span>, and zero otherwise. This leads to the following result: <span class="math display">
\braket{f(X)} = \frac{1}{b-a} \int_{a}^{b} f(x) dx.
</span></p>
<p>Except for the <span class="math inline">1/(b-a)</span> prefactor, the right-hand side is exactly the numerical integration problem we would like to solve.</p>
<p>To keep the terminology straight, we will call this <span class="math inline">\braket{f(X)}</span> the <em>population mean</em>.</p>
<p>Similarly, we introduce the <em>variance</em> of a function of a random variable, in terms of an integral: <span class="math display">
\mathrm{var}[f(X)] = \braket{[f(X) - \braket{f(X)}]^2}
</span> and specialize to the case where <span class="math inline">p(x) = 1/(b - a)</span>, to find <span class="math display">
\mathrm{var}[f(x)] = \frac{1}{b-a}\int_{a}^b f^2(x)dx
- \left(\frac{1}{b-a}\int_a^b f(x) dx \right)^2
</span> We call this the <em>population variance</em>, and its square root the <em>population standard deviation</em>,<span class="math inline">\mathrm{var}[f(X)]</span>.</p>
<p>Crucially, both the population mean and the population variance, <span class="math inline">\braket{f(X)}</span> and <span class="math inline">\mathrm{var}[f(X)]</span>, are unknown, i.e., we don’t know the value of either <span class="math inline">\int_a^b f(x)dx</span> or <span class="math inline">\int_a^b f^2(x)dx</span>; this is precisely why we wish to employ Monte Carlo integration. In what follows, we will learn how to estimate both <span class="math inline">\braket{f(X)}</span> and <span class="math inline">\mathrm{var}[f(X)]</span>.</p>
</section>
<section id="sample-mean-and-its-variance" class="level3">
<h3 class="anchored" data-anchor-id="sample-mean-and-its-variance">Sample Mean and Its Variance</h3>
<p>Assume that the random variables <span class="math inline">X_0, X_1, X_2, \dots, X_{n-1}</span> are drawn randomly from <span class="math inline">p(x)</span>, which for us is uniform from <span class="math inline">a</span> to <span class="math inline">b</span>. For each of these random variables <span class="math inline">X_i</span>, we act with the function <span class="math inline">f</span>, leading to <span class="math inline">n</span> new random variables, <span class="math inline">f(X_0), f(X_1), f(X_2),\dots, f(X_{n−1})</span>.</p>
<p>The <em>arithmetic average</em> of several random variables is also a random variable. We define: <span class="math display">
\overline{f} = \frac{1}{n}\sum_{i=0}^{n-1} f(X_i)
</span> which we call the <em>sample mean</em>. It is the arithmetic average of the function value over <span class="math inline">n</span> samples. Crucially, this <span class="math inline">\overline{f}</span> is a quantity computed from a finite number of samples, <span class="math inline">n</span>; this means it is quite different from the population mean, <span class="math inline">\braket{f(X)}</span>.</p>
<p>We will now see that the sample mean, <span class="math inline">\overline{f}</span>, can be used to estimate the population mean, <span class="math inline">\braket{f(X)}</span>. Let us examine the expectation of the sample mean <span class="math display">
\braket{\overline{f}} = \braket{\frac{1}{n} \sum_{i=0}^{n-1} f(X_i)} = \frac{1}{n}\sum_{i=0}^{n-1}\braket{f(X)} = \braket{f(X)}.
</span></p>
<p>In words, our result is that the <em>expectation of the sample mean is equal to the population mean</em>. This motivates our choice to use <span class="math inline">\overline{f}</span> as an estimator of <span class="math inline">f(X)</span>; for us an estimator is a useful approximation of a given quantity. It can be shown that as <span class="math inline">n\to\infty</span>, <span class="math inline">\overline{f}\to\braket{f(X)}</span>.</p>
<p>In order to quantify how fast the sample mean approaches the population mean, we turn to the <em>variance of the sample mean</em>: <span class="math display">
\mathrm{var}(\overline{f}) = \mathrm{var}\left(\frac{1}{n}\sum_{i=0}^{n-1}f(X_i)\right) = \frac{1}{n^2} \sum_{i=0}^{n-1} \mathrm{var}[f(X)] = \frac{1}{n}\mathrm{var}[f(X)],
</span> where we have used the property of variance <span class="math display">
\mathrm{var}(\lambda_1 X_1 + \lambda_2 X_2)  = \lambda_1^2 \mathrm{var}(X_1)
+ \lambda_2^2 \mathrm{var}(X_2).
</span></p>
<p>Thus, our result states that <em>the variance of the sample mean decreases as <span class="math inline">1/n</span>.</em> The standard deviation of the sample means goes as <span class="math inline">1/\sqrt{n}</span>, because <span class="math display">
\sqrt{\mathrm{var}(\overline{f})} = \frac{1}{\sqrt{n}} \sqrt{\mathrm{var}[f(X)]}.
</span></p>
<p>Notice that on the right hand side the quantity <span class="math inline">\mathrm{var}[f(x)]</span> is not known, we need to come up with an estimator for <span class="math inline">\mathrm{var}[f(X)]</span>. We propose an estimator <span class="math display">
e_{var} = \overline{f^2} - \overline{f}^2 = \frac{1}{n}\sum_{i=0}^{n-1}f^2(X_i) - \left[\frac{1}{n}\sum_{i=0}^{n-1} f(X_i)\right]^2
</span></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>