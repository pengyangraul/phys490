<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.256">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Meeting 4 (Nov.&nbsp;16)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="meeting4_files/libs/clipboard/clipboard.min.js"></script>
<script src="meeting4_files/libs/quarto-html/quarto.js"></script>
<script src="meeting4_files/libs/quarto-html/popper.min.js"></script>
<script src="meeting4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="meeting4_files/libs/quarto-html/anchor.min.js"></script>
<link href="meeting4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="meeting4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="meeting4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="meeting4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="meeting4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#week-8" id="toc-week-8" class="nav-link active" data-scroll-target="#week-8">Week 8</a>
  <ul class="collapse">
  <li><a href="#problem-1" id="toc-problem-1" class="nav-link" data-scroll-target="#problem-1">Problem 1</a></li>
  <li><a href="#problem-2" id="toc-problem-2" class="nav-link" data-scroll-target="#problem-2">Problem 2</a></li>
  <li><a href="#problem-3" id="toc-problem-3" class="nav-link" data-scroll-target="#problem-3">Problem 3</a></li>
  </ul></li>
  <li><a href="#week-9" id="toc-week-9" class="nav-link" data-scroll-target="#week-9">Week 9</a></li>
  <li><a href="#week-10" id="toc-week-10" class="nav-link" data-scroll-target="#week-10">Week 10</a>
  <ul class="collapse">
  <li><a href="#problem" id="toc-problem" class="nav-link" data-scroll-target="#problem"><strong>Problem</strong></a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Meeting 4 (Nov.&nbsp;16)</h1>
<p class="subtitle lead">Discussing problems in Weeks 8, 9, 10</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="week-8" class="level2">
<h2 class="anchored" data-anchor-id="week-8">Week 8</h2>
<section id="problem-1" class="level3">
<h3 class="anchored" data-anchor-id="problem-1">Problem 1</h3>
<p><strong>Deriving Eq. 3</strong></p>
<p>Let us work out this problem term by term. <span class="math display">
\boldsymbol{S}_{z}\otimes\boldsymbol{I}=\frac{1}{2}\left(\begin{array}{cccc}
1\\
&amp; 1\\
&amp;  &amp; -1\\
&amp;  &amp;  &amp; -1
\end{array}\right),\quad\boldsymbol{I}\otimes\boldsymbol{S}_{z}=\frac{1}{2}\left(\begin{array}{cccc}
1\\
&amp; -1\\
&amp;  &amp; 1\\
&amp;  &amp;  &amp; -1
\end{array}\right),\quad\boldsymbol{S}_{z}\otimes\boldsymbol{S}_{z}=\frac{1}{4}\left(\begin{array}{cccc}
1\\
&amp; -1\\
&amp;  &amp; -1\\
&amp;  &amp;  &amp; 1
\end{array}\right).
</span> which gives the diagonal elements <span class="math display">
-\omega_{I}\boldsymbol{S}_{z}\otimes\boldsymbol{I}-\omega_{II}\boldsymbol{I}\otimes\boldsymbol{S}_{z}+\gamma\boldsymbol{S}_{z}\otimes\boldsymbol{S}_{z}=-\frac{1}{2}\left(\begin{array}{cccc}
\omega_{I}+\omega_{II}-\frac{\gamma}{2}\\
&amp; \omega_{I}-\omega_{II}+\frac{\gamma}{2}\\
&amp;  &amp; -\omega_{I}+\omega_{II}+\frac{\gamma}{2} &amp; \frac{\gamma}{2}\\
&amp;  &amp;  &amp; -\omega_{I}-\omega_{II}-\frac{\gamma}{2}
\end{array}\right).
</span></p>
<p>For the off-diagonal terms, we use <span class="math display">
S_{x}\otimes S_{x}=\frac{1}{4}\left(\begin{array}{cccc}
&amp;  &amp;  &amp; 1\\
&amp;  &amp; 1\\
&amp; 1\\
1
\end{array}\right),\quad S_{y}\otimes S_{y}=\frac{1}{4}\left(\begin{array}{cccc}
&amp;  &amp;  &amp; -1\\
&amp;  &amp; 1\\
&amp; 1\\
-1
\end{array}\right),
</span> which leads to <span class="math display">
\gamma(\boldsymbol{S}_{x}\otimes\boldsymbol{S}_{x}+\boldsymbol{S}_{y}\otimes\boldsymbol{S}_{y})=\frac{1}{2}\left(\begin{array}{cccc}
&amp;  &amp;  &amp; 0\\
&amp;  &amp; \gamma\\
&amp; \gamma\\
0
\end{array}\right).
</span></p>
</section>
<section id="problem-2" class="level3">
<h3 class="anchored" data-anchor-id="problem-2">Problem 2</h3>
<p><strong>Prove <span class="math inline">(A\otimes B)(C\otimes D) = (AC)\otimes(BD)</span></strong>.</p>
<p>Let us assume <span class="math inline">\boldsymbol{A}</span>, <span class="math inline">\boldsymbol{B}</span>, <span class="math inline">\boldsymbol{C}</span> and <span class="math inline">\boldsymbol{D}</span> to be <span class="math inline">n\times m</span>, <span class="math inline">p\times q</span>, <span class="math inline">m\times l</span> and <span class="math inline">q\times r</span> matrices respectively. We have <span class="math inline">(\boldsymbol{A}\otimes \boldsymbol{B})</span> is a <span class="math inline">np\times mq</span> matrix, and <span class="math inline">(\boldsymbol{C}\otimes \boldsymbol{D})</span> is a <span class="math inline">mq\times lr</span> matrix. Further, <span class="math inline">(\boldsymbol{A}\otimes\boldsymbol{B})(\boldsymbol{C}\otimes\boldsymbol{D})</span> is a <span class="math inline">np\times lr</span> matrix.</p>
<p>In the following, we shall use the following fact: an index <span class="math inline">a=0,1,\dots,np-1</span> can always be labeled uniquely by two indices <span class="math inline">i,j</span> as <span class="math inline">a=pi+j</span>, with <span class="math inline">i=0,1,\dots n-1</span> and <span class="math inline">j=0,1,\dots p-1</span>.</p>
<p>Further, <span class="math inline">(\boldsymbol{A}\otimes\boldsymbol{B})(\boldsymbol{C}\otimes\boldsymbol{D})</span> is a <span class="math inline">np\times lr</span> matrix. Now, we consider the matrix element <span class="math display">
[(\boldsymbol{A}\otimes\boldsymbol{B})(\boldsymbol{C}\otimes\boldsymbol{D})]_{pi+j,rk+h}
</span> in which <span class="math inline">i=0,\dots n-1</span>, <span class="math inline">k=0,\dots l-1</span>, <span class="math inline">j=0,\dots,p-1</span>, <span class="math inline">h=0,\dots,r-1</span>, <span class="math inline">t=0,\dots m-1</span> and <span class="math inline">s=0,\dots q-1</span>.</p>
<p>Using the definition of matrix product, by introducing an intermediate variable <span class="math inline">x=0,1,\dots,mq-1</span>, one can write <span class="math display">
\begin{align*}
[(\boldsymbol{A}\otimes\boldsymbol{B})(\boldsymbol{C}\otimes\boldsymbol{D})]_{pi+j,rk+h} &amp; =\sum_{x}(\boldsymbol{A}\otimes\boldsymbol{B})_{pi+j,x}(\boldsymbol{C}\otimes\boldsymbol{D})_{x,rk+h}\\
&amp; =\sum_{ts}(\boldsymbol{A}\otimes\boldsymbol{B})_{pi+j,qt+s}(\boldsymbol{C}\otimes\boldsymbol{D})_{qt+s,rk+h}\\
&amp; =\sum_{ts}A_{it}B_{js}C_{tk}D_{sh}\\
&amp; =(\sum_{t}A_{it}C_{tk})(\sum_{s}B_{js}D_{sh})\\
&amp; =(\boldsymbol{AC})_{ik}(\boldsymbol{BD})_{jh}\\
&amp; =[(\boldsymbol{AC)}\otimes\boldsymbol{(BD})]_{pi+j,rk+h}.
\end{align*}
</span> Note that in the second line we have used the fact that one can uniquely write <span class="math inline">x=qt+s</span>.</p>
</section>
<section id="problem-3" class="level3">
<h3 class="anchored" data-anchor-id="problem-3">Problem 3</h3>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> twospins(omI,omII,gam):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    hbar <span class="op">=</span> <span class="fl">1.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    paulis <span class="op">=</span> paulimatrices()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    iden <span class="op">=</span> np.identity(<span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    SIs <span class="op">=</span> [hbar<span class="op">*</span>kron(pa,iden)<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> pa <span class="kw">in</span> paulis]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    SIIs <span class="op">=</span> [hbar<span class="op">*</span>kron(iden,pa)<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> pa <span class="kw">in</span> paulis]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    SIdotII <span class="op">=</span> <span class="bu">sum</span>([SIs[i]<span class="op">@</span>SIIs[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>)])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> <span class="op">-</span>omI<span class="op">*</span>SIs[<span class="dv">2</span>] <span class="op">-</span> omII<span class="op">*</span>SIIs[<span class="dv">2</span>] <span class="op">+</span> gam<span class="op">*</span>SIdotII</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> H.real</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> H</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> paulimatrices():</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    sigx <span class="op">=</span> np.array([<span class="fl">0.</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    sigy <span class="op">=</span> np.array([<span class="fl">0.</span>,<span class="op">-</span><span class="ot">1j</span>,<span class="ot">1j</span>,<span class="dv">0</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    sigz <span class="op">=</span> np.array([<span class="fl">1.</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sigx, sigy, sigz</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kron(U,V):</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> U.shape[<span class="dv">0</span>]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> V.shape[<span class="dv">0</span>]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    W <span class="op">=</span> np.zeros((n<span class="op">*</span>p,n<span class="op">*</span>p), dtype<span class="op">=</span>np.complex64)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(p):</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(p):</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                    W[p<span class="op">*</span>i<span class="op">+</span>j,p<span class="op">*</span>k<span class="op">+</span>l] <span class="op">=</span> U[i,k]<span class="op">*</span>V[j,l]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> W</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> qrmet(inA,kmax<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> np.copy(inA)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,kmax):</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        Q, R <span class="op">=</span> qrdec(A)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        A <span class="op">=</span> R<span class="op">@</span>Q</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(k, np.diag(A))</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    qreigvals <span class="op">=</span> np.diag(A)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> qreigvals</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> qrdec(A):</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> A.shape[<span class="dv">0</span>]</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    Ap <span class="op">=</span> np.copy(A)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    Q <span class="op">=</span> np.zeros((n,n))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> np.zeros((n,n))</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j):</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>            R[i,j] <span class="op">=</span> Q[:,i]<span class="op">@</span>A[:,j]</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            Ap[:,j] <span class="op">-=</span> R[i,j]<span class="op">*</span>Q[:,i]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        R[j,j] <span class="op">=</span> mag(Ap[:,j])</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        Q[:,j] <span class="op">=</span> Ap[:,j]<span class="op">/</span>R[j,j]</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Q, R</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mag(xs):</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(np.<span class="bu">sum</span>(xs<span class="op">*</span>xs))</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    n_omegas <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    omega_I <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="fl">3.0</span>,n_omegas)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    eigenvalues <span class="op">=</span> np.zeros((n_omegas, <span class="dv">4</span>))</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> jj <span class="kw">in</span> <span class="bu">range</span>(n_omegas):</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        H <span class="op">=</span> twospins(omega_I[jj],<span class="dv">2</span><span class="op">*</span>omega_I[jj], gamma)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        eigenvalues[jj] <span class="op">=</span> qrmet(H)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    plt.plot(omega_I,eigenvalues,<span class="st">'k-'</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="vs">r'$\omega_I$'</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Eigenvalues'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="meeting4_files/figure-html/cell-2-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="week-9" class="level2">
<h2 class="anchored" data-anchor-id="week-9">Week 9</h2>
<p><strong>Problem: Code up Newton’s method for our example function <span class="math inline">f(x) = e^{x-\sqrt{x}} -x</span> and use it to find out the roots.</strong></p>
<p>To apply Newton’s method, we need the first order derivative of <span class="math inline">f(x)</span>. Luckily, we can compute this analytically <span class="math display">
f'(x) = (1-\frac{1}{2\sqrt{x}})e^{x - \sqrt{x}} - 1.
</span></p>
<p>Then we can write the following code, by defining the derivative <code>f_der</code>.</p>
<p>For Newton’s method, we use the updating rule: <span class="math display">
x^{(k)} = x^{(k-1)} - \frac{f(x^{(k-1)})}{f'(x^{(k-1)})}.
</span></p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(x <span class="op">-</span> np.sqrt(x)) <span class="op">-</span> x</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f_der(x):</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span><span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.sqrt(x)))<span class="op">*</span>np.exp(x <span class="op">-</span> np.sqrt(x)) <span class="op">-</span> <span class="fl">1.0</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> newton(f,f_der,x0,kmax<span class="op">=</span><span class="dv">200</span>,tol<span class="op">=</span><span class="fl">1.e-8</span>):</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,kmax):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        f0 <span class="op">=</span> f(x0)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        f_der0 <span class="op">=</span> f_der(x0)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        dx <span class="op">=</span> f0<span class="op">/</span>f_der0</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x0 <span class="op">-</span> dx</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(dx)<span class="op">&lt;</span>tol:</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x1</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x1</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> newton(f,f_der,<span class="fl">0.3</span>) </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Root1:"</span>,root)<span class="op">;</span> <span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> newton(f,f_der,<span class="fl">2.</span>) </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Root2:"</span>,root)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root1: 1.0

Root2: 2.4909093169459857</code></pre>
</div>
</div>
</section>
<section id="week-10" class="level2">
<h2 class="anchored" data-anchor-id="week-10">Week 10</h2>
<section id="problem" class="level3">
<h3 class="anchored" data-anchor-id="problem"><strong>Problem</strong></h3>
<p>Modify the above code for minimizing the action to address the physical context of the <em>harmonic oscillator</em>, namely <span class="math display">
V(x) = \frac{1}{2}x^2
</span> Take <span class="math inline">m=1</span>, <span class="math inline">x_0 = 0</span>, <span class="math inline">x_{n−1} = 1</span> and <span class="math inline">T = 1</span>. Plot the coordinate <span class="math inline">x(t)</span> of the particle as a function of time; also show the (analytically known) answer.</p>
<section id="analytical-solution" class="level4">
<h4 class="anchored" data-anchor-id="analytical-solution">Analytical Solution</h4>
<p>For a particle moving in the harmonic potential <span class="math inline">V(x) = x^2/2</span>, we can use the Newton’s second law <span class="math display">
m\ddot{x} = F(x) = -V'(x)  = -x.
</span> Taking <span class="math inline">m = 1</span>, we can simply write it as <span class="math inline">\ddot{x} = -x</span>. The general solution to this differential equation is <span class="math display">
x(t) = A\cos(t) + B\sin(t).
</span> Using the boundary condition <span class="math inline">x(0) = 0</span>, <span class="math inline">x(T) = 1</span>, we have <span class="math inline">A=0</span>, <span class="math inline">B = 1/\sin(T)</span>. Thus, we have the analytical solution <span class="math display">
x(t) = \frac{\sin(t)}{\sin(T)}.
</span></p>
</section>
<section id="numerical-implementation" class="level4">
<h4 class="anchored" data-anchor-id="numerical-implementation">Numerical implementation</h4>
<p>You just need to modify the force and force derivative function <code>fod(der,x)</code>.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> params():</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    nvar <span class="op">=</span> <span class="dv">199</span><span class="op">;</span> m <span class="op">=</span> <span class="fl">1.</span> <span class="co"># We have 99 middle points, 1,2,...,99</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    xini, xfin <span class="op">=</span> <span class="fl">0.</span>, <span class="fl">1.</span> <span class="co"># end points are fixed at 2 and 0</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    tt <span class="op">=</span> <span class="fl">1.</span><span class="op">;</span> dt <span class="op">=</span> tt<span class="op">/</span>(nvar<span class="op">+</span><span class="dv">1</span>) <span class="co"># total time 1</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nvar, m, xini, xfin, dt, tt</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fod(der,x):</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>x <span class="cf">if</span> der<span class="op">==</span><span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span>np.ones_like(x)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient(xs):</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    nvar, m, xini, xfin, dt,tt <span class="op">=</span> params()</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    arr <span class="op">=</span> np.zeros(nvar)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    arr[<span class="dv">0</span>] <span class="op">=</span> (m<span class="op">/</span>dt)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>xs[<span class="dv">0</span>]<span class="op">-</span>xini<span class="op">-</span>xs[<span class="dv">1</span>]) <span class="op">+</span> dt <span class="op">*</span> fod(<span class="dv">0</span>,xs[<span class="dv">0</span>])</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    arr[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (m<span class="op">/</span>dt)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>xs[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> xs[:<span class="op">-</span><span class="dv">2</span>] <span class="op">-</span> xs[<span class="dv">2</span>:]) <span class="op">+</span> dt<span class="op">*</span>fod(<span class="dv">0</span>,xs[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    arr[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (m<span class="op">/</span>dt)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>xs[<span class="op">-</span><span class="dv">1</span>]<span class="op">-</span>xs[<span class="op">-</span><span class="dv">2</span>]<span class="op">-</span>xfin) <span class="op">+</span>dt <span class="op">*</span> fod(<span class="dv">0</span>,xs[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> arr</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hessian(xs):</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    nvar, m, xini, xfin, dt,tt <span class="op">=</span> params()</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    he <span class="op">=</span> np.diag(<span class="dv">2</span><span class="op">*</span>m<span class="op">/</span>dt<span class="op">+</span> dt<span class="op">*</span>fod(<span class="dv">1</span>,xs))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(he[<span class="dv">1</span>:,:], <span class="op">-</span>m<span class="op">/</span>dt)   </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(he[:,<span class="dv">1</span>:], <span class="op">-</span>m<span class="op">/</span>dt)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> he</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multi_newton(gradient,hessian,xolds,kmax<span class="op">=</span><span class="dv">200</span>,tol<span class="op">=</span><span class="fl">1.e-10</span>):</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,kmax):</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        grad_xolds <span class="op">=</span> gradient(xolds)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        he_xolds <span class="op">=</span> hessian(xolds)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        xnews <span class="op">=</span> xolds <span class="op">+</span> gauelim_pivot(he_xolds, <span class="op">-</span>grad_xolds)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        err <span class="op">=</span> termcrit(xolds,xnews)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(k, xnews, err)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> err <span class="op">&lt;</span> tol:</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        xolds <span class="op">=</span> np.copy(xnews)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        xnews <span class="op">=</span> <span class="va">None</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xnews</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gauelim_pivot(inA,inbs):</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> np.copy(inA)</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    bs <span class="op">=</span> np.copy(inbs)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> bs.size</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> np.argmax(np.<span class="bu">abs</span>(A[j:,j])) <span class="op">+</span> j</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="op">!=</span> j:</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>            A[j,:], A[k,:] <span class="op">=</span> A[k,:], A[j,:].copy()</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>            bs[j], bs[k] <span class="op">=</span> bs[k], bs[j]</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>,n):</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>            coeff <span class="op">=</span> A[i,j]<span class="op">/</span>A[j,j]</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>            A[i,j:] <span class="op">-=</span> coeff<span class="op">*</span>A[j,j:]</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>            bs[i] <span class="op">-=</span> coeff<span class="op">*</span>bs[j]</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    xs <span class="op">=</span> backsub(A,bs)</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xs</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backsub(U,bs):</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> bs.size</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    xs <span class="op">=</span> np.zeros(n)</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">reversed</span>(<span class="bu">range</span>(n)):</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>        xs[i] <span class="op">=</span> (bs[i] <span class="op">-</span> U[i,i<span class="op">+</span><span class="dv">1</span>:]<span class="op">@</span>xs[i<span class="op">+</span><span class="dv">1</span>:])<span class="op">/</span>U[i,i]</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xs</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> termcrit(xolds,xnews):</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    errs <span class="op">=</span> np.<span class="bu">abs</span>((xnews <span class="op">-</span> xolds)<span class="op">/</span>xnews)</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>(errs)</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> x_analytical(t,tt):</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sin(t)<span class="op">/</span>np.sin(tt)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    nvar, m, xini, xfin, dt,tt <span class="op">=</span> params()</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>    xolds <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,nvar<span class="op">+</span><span class="dv">2</span>)[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    xnews <span class="op">=</span> multi_newton(gradient, hessian, xolds)<span class="op">;</span> <span class="bu">print</span>(xnews)</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    tlist <span class="op">=</span> np.linspace(<span class="dv">0</span>,tt,nvar<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    plt.plot(tlist[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>],xolds,label<span class="op">=</span><span class="st">'initial guess'</span>)</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    plt.plot(tlist[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>],xnews, label<span class="op">=</span><span class="st">'minimized'</span>)</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    plt.plot(tlist[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>],x_analytical(tlist[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>],tt), <span class="st">'--'</span>,label<span class="op">=</span><span class="st">'analytical'</span>)</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'t'</span>)</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'x(t)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 [0.00594195 0.01188376 0.01782526 0.02376633 0.02970679 0.03564652
 0.04158535 0.04752315 0.05345975 0.05939502 0.06532881 0.07126096
 0.07719133 0.08311977 0.08904613 0.09497027 0.10089203 0.10681127
 0.11272784 0.11864159 0.12455237 0.13046004 0.13636445 0.14226545
 0.1481629  0.15405664 0.15994653 0.16583242 0.17171416 0.17759161
 0.18346462 0.18933305 0.19519674 0.20105555 0.20690933 0.21275795
 0.21860124 0.22443907 0.23027128 0.23609775 0.2419183  0.24773281
 0.25354113 0.25934311 0.2651386  0.27092747 0.27670956 0.28248474
 0.28825285 0.29401376 0.29976731 0.30551338 0.3112518  0.31698244
 0.32270516 0.32841981 0.33412625 0.33982434 0.34551393 0.35119489
 0.35686706 0.36253031 0.3681845  0.37382949 0.37946513 0.38509128
 0.3907078  0.39631456 0.40191141 0.40749821 0.41307482 0.41864111
 0.42419693 0.42974215 0.43527662 0.44080021 0.44631278 0.4518142
 0.45730431 0.462783   0.46825011 0.47370552 0.47914909 0.48458068
 0.49000015 0.49540737 0.50080221 0.50618453 0.51155419 0.51691107
 0.52225502 0.52758591 0.53290362 0.538208   0.54349893 0.54877627
 0.55403989 0.55928966 0.56452545 0.56974713 0.57495456 0.58014761
 0.58532617 0.59049009 0.59563925 0.60077351 0.60589276 0.61099686
 0.61608569 0.62115911 0.626217   0.63125924 0.6362857  0.64129625
 0.64629077 0.65126913 0.65623121 0.66117688 0.66610603 0.67101852
 0.67591423 0.68079305 0.68565485 0.6904995  0.6953269  0.70013691
 0.70492942 0.7097043  0.71446144 0.71920072 0.72392202 0.72862522
 0.73331021 0.73797686 0.74262507 0.74725471 0.75186566 0.75645782
 0.76103107 0.7655853  0.77012038 0.77463621 0.77913268 0.78360966
 0.78806706 0.79250475 0.79692264 0.80132059 0.80569852 0.8100563
 0.81439384 0.81871101 0.82300771 0.82728384 0.83153929 0.83577395
 0.83998771 0.84418048 0.84835214 0.85250259 0.85663173 0.86073945
 0.86482565 0.86889024 0.8729331  0.87695414 0.88095325 0.88493034
 0.88888531 0.89281805 0.89672848 0.90061648 0.90448198 0.90832485
 0.91214503 0.91594239 0.91971686 0.92346834 0.92719673 0.93090194
 0.93458387 0.93824244 0.94187756 0.94548913 0.94907706 0.95264127
 0.95618165 0.95969814 0.96319063 0.96665904 0.97010329 0.97352328
 0.97691894 0.98029017 0.98363689 0.98695903 0.99025649 0.99352919
 0.99677705] 21.56870187420532
2 [0.00594195 0.01188376 0.01782526 0.02376633 0.02970679 0.03564652
 0.04158535 0.04752315 0.05345975 0.05939502 0.06532881 0.07126096
 0.07719133 0.08311977 0.08904613 0.09497027 0.10089203 0.10681127
 0.11272784 0.11864159 0.12455237 0.13046004 0.13636445 0.14226545
 0.1481629  0.15405664 0.15994653 0.16583242 0.17171416 0.17759161
 0.18346462 0.18933305 0.19519674 0.20105555 0.20690933 0.21275795
 0.21860124 0.22443907 0.23027128 0.23609775 0.2419183  0.24773281
 0.25354113 0.25934311 0.2651386  0.27092747 0.27670956 0.28248474
 0.28825285 0.29401376 0.29976731 0.30551338 0.3112518  0.31698244
 0.32270516 0.32841981 0.33412625 0.33982434 0.34551393 0.35119489
 0.35686706 0.36253031 0.3681845  0.37382949 0.37946513 0.38509128
 0.3907078  0.39631456 0.40191141 0.40749821 0.41307482 0.41864111
 0.42419693 0.42974215 0.43527662 0.44080021 0.44631278 0.4518142
 0.45730431 0.462783   0.46825011 0.47370552 0.47914909 0.48458068
 0.49000015 0.49540737 0.50080221 0.50618453 0.51155419 0.51691107
 0.52225502 0.52758591 0.53290362 0.538208   0.54349893 0.54877627
 0.55403989 0.55928966 0.56452545 0.56974713 0.57495456 0.58014761
 0.58532617 0.59049009 0.59563925 0.60077351 0.60589276 0.61099686
 0.61608569 0.62115911 0.626217   0.63125924 0.6362857  0.64129625
 0.64629077 0.65126913 0.65623121 0.66117688 0.66610603 0.67101852
 0.67591423 0.68079305 0.68565485 0.6904995  0.6953269  0.70013691
 0.70492942 0.7097043  0.71446144 0.71920072 0.72392202 0.72862522
 0.73331021 0.73797686 0.74262507 0.74725471 0.75186566 0.75645782
 0.76103107 0.7655853  0.77012038 0.77463621 0.77913268 0.78360966
 0.78806706 0.79250475 0.79692264 0.80132059 0.80569852 0.8100563
 0.81439384 0.81871101 0.82300771 0.82728384 0.83153929 0.83577395
 0.83998771 0.84418048 0.84835214 0.85250259 0.85663173 0.86073945
 0.86482565 0.86889024 0.8729331  0.87695414 0.88095325 0.88493034
 0.88888531 0.89281805 0.89672848 0.90061648 0.90448198 0.90832485
 0.91214503 0.91594239 0.91971686 0.92346834 0.92719673 0.93090194
 0.93458387 0.93824244 0.94187756 0.94548913 0.94907706 0.95264127
 0.95618165 0.95969814 0.96319063 0.96665904 0.97010329 0.97352328
 0.97691894 0.98029017 0.98363689 0.98695903 0.99025649 0.99352919
 0.99677705] 1.9789752152203537e-12
[0.00594195 0.01188376 0.01782526 0.02376633 0.02970679 0.03564652
 0.04158535 0.04752315 0.05345975 0.05939502 0.06532881 0.07126096
 0.07719133 0.08311977 0.08904613 0.09497027 0.10089203 0.10681127
 0.11272784 0.11864159 0.12455237 0.13046004 0.13636445 0.14226545
 0.1481629  0.15405664 0.15994653 0.16583242 0.17171416 0.17759161
 0.18346462 0.18933305 0.19519674 0.20105555 0.20690933 0.21275795
 0.21860124 0.22443907 0.23027128 0.23609775 0.2419183  0.24773281
 0.25354113 0.25934311 0.2651386  0.27092747 0.27670956 0.28248474
 0.28825285 0.29401376 0.29976731 0.30551338 0.3112518  0.31698244
 0.32270516 0.32841981 0.33412625 0.33982434 0.34551393 0.35119489
 0.35686706 0.36253031 0.3681845  0.37382949 0.37946513 0.38509128
 0.3907078  0.39631456 0.40191141 0.40749821 0.41307482 0.41864111
 0.42419693 0.42974215 0.43527662 0.44080021 0.44631278 0.4518142
 0.45730431 0.462783   0.46825011 0.47370552 0.47914909 0.48458068
 0.49000015 0.49540737 0.50080221 0.50618453 0.51155419 0.51691107
 0.52225502 0.52758591 0.53290362 0.538208   0.54349893 0.54877627
 0.55403989 0.55928966 0.56452545 0.56974713 0.57495456 0.58014761
 0.58532617 0.59049009 0.59563925 0.60077351 0.60589276 0.61099686
 0.61608569 0.62115911 0.626217   0.63125924 0.6362857  0.64129625
 0.64629077 0.65126913 0.65623121 0.66117688 0.66610603 0.67101852
 0.67591423 0.68079305 0.68565485 0.6904995  0.6953269  0.70013691
 0.70492942 0.7097043  0.71446144 0.71920072 0.72392202 0.72862522
 0.73331021 0.73797686 0.74262507 0.74725471 0.75186566 0.75645782
 0.76103107 0.7655853  0.77012038 0.77463621 0.77913268 0.78360966
 0.78806706 0.79250475 0.79692264 0.80132059 0.80569852 0.8100563
 0.81439384 0.81871101 0.82300771 0.82728384 0.83153929 0.83577395
 0.83998771 0.84418048 0.84835214 0.85250259 0.85663173 0.86073945
 0.86482565 0.86889024 0.8729331  0.87695414 0.88095325 0.88493034
 0.88888531 0.89281805 0.89672848 0.90061648 0.90448198 0.90832485
 0.91214503 0.91594239 0.91971686 0.92346834 0.92719673 0.93090194
 0.93458387 0.93824244 0.94187756 0.94548913 0.94907706 0.95264127
 0.95618165 0.95969814 0.96319063 0.96665904 0.97010329 0.97352328
 0.97691894 0.98029017 0.98363689 0.98695903 0.99025649 0.99352919
 0.99677705]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="meeting4_files/figure-html/cell-4-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>